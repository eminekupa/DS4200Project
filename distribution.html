<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Distribution Channel Impact - Mediterranean Hotel Dynamics</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="style.css">
  <!-- D3.js -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand" href="index.html">Mediterranean Hotel Analysis</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link active" href="distribution.html">Distribution Channels</a></li>
          <li class="nav-item"><a class="nav-link" href="loyalty.html">Guest Loyalty</a></li>
          <li class="nav-item"><a class="nav-link" href="geography.html">Geographic Analysis</a></li>
          <li class="nav-item"><a class="nav-link" href="roomRates_travelerCancel.html">Demographics</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <header class="py-5 bg-light">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 text-center">
          <h1 class="fw-bold">Distribution Channel Impact</h1>
          <h2 class="mb-4">How Booking Methods Influence Hotel Cancellation Rates</h2>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <section class="py-5">
    <div class="container">
      <!-- Overview -->
      <div class="row mb-5">
        <div class="col-lg-8 mx-auto">
          <h3 class="mb-4">Analysis Overview</h3>
          <p class="lead">
            This static bar chart explores the cancellation rates across different booking distribution channels in Spanish hotels.
            As part of our Mediterranean hotel analysis, we investigate which booking methods — such as travel agents, direct booking,
            or online travel agencies — are more prone to cancellations.
          </p>
        </div>
      </div>

      <!-- Visualization -->
      <div class="row mb-5">
        <div class="col-lg-10 mx-auto">
          <svg width="100%" height="500px" id="d3-chart"></svg>
          <div class="text-center mt-3">
            <p class="text-muted fst-italic">Cancellation Rate by Distribution Channel (Spain)</p>
          </div>
        </div>
      </div>

      <!-- Insight -->
      <div class="row mb-5">
        <div class="col-lg-8 mx-auto">
          <h3 class="mb-4">Key Takeaway</h3>
          <p>
            This visualization shows that bookings made through Travel Agents tend to have the highest cancellation rate,
            followed by Online Travel Agents. On the other hand, Direct Bookings demonstrate the lowest
            cancellation rate. This trend suggests that encouraging more direct booking could be a viable strategy for reducing volatility
            in hotel operations and improving revenue forecasting.
          </p>
        </div>
      </div>

      <!-- Visualization Design -->
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <h3 class="mb-4">Static Visualization Design</h3>
          <p>
            This D3 bar chart includes key elements of an effective static visualization: a clear title, labeled axes, and a consistent
            blue-to-orange color scheme for interactivity. The bars highlight comparative cancellation rates with hover effects for better engagement.
            The layout uses Bootstrap for responsiveness and integrates smoothly into the site’s overall design system.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="py-4 bg-dark text-white-50">
    <div class="container text-center">
      <small>Mediterranean Hotel Dynamics - Data Visualization Project</small>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

  <!-- D3 Chart Script -->
  <script>
    const svg = d3.select("#d3-chart"),
          margin = {top: 40, right: 20, bottom: 60, left: 80},
          width = parseInt(svg.style("width")) - margin.left - margin.right,
          height = parseInt(svg.style("height")) - margin.top - margin.bottom;

    const chart = svg.append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);

    d3.csv("d3_distribution_cancellation.csv").then(data => {
      data.forEach(d => {
        d.cancel_rate = +d.cancel_rate;
      });

      const x = d3.scaleBand()
          .domain(data.map(d => d.DistributionChannel))
          .range([0, width])
          .padding(0.2);

      const y = d3.scaleLinear()
          .domain([0, d3.max(data, d => d.cancel_rate)])
          .nice()
          .range([height, 0]);

      chart.append("g")
          .attr("transform", `translate(0,${height})`)
          .call(d3.axisBottom(x))
          .selectAll("text")
            .attr("transform", "rotate(-25)")
            .style("text-anchor", "end");

      chart.append("g")
          .call(d3.axisLeft(y).tickFormat(d3.format(".0%")));

      chart.selectAll(".bar")
          .data(data)
          .enter().append("rect")
            .attr("class", "bar")
            .attr("x", d => x(d.DistributionChannel))
            .attr("y", d => y(d.cancel_rate))
            .attr("width", x.bandwidth())
            .attr("height", d => height - y(d.cancel_rate))
            .attr("fill", "steelblue")
            .on("mouseover", function () {
              d3.select(this).attr("fill", "darkorange");
            })
            .on("mouseout", function () {
              d3.select(this).attr("fill", "steelblue");
            });

      // Axis labels
      svg.append("text")
        .attr("x", width / 2 + margin.left)
        .attr("y", height + margin.top + 50)
        .attr("class", "axis-label")
        .style("text-anchor", "middle")
        .text("Distribution Channel");

      svg.append("text")
        .attr("transform", "rotate(-90)")
        .attr("y", margin.left / 3)
        .attr("x", 0 - (height / 2) - margin.top)
        .attr("dy", "1em")
        .attr("class", "axis-label")
        .style("text-anchor", "middle")
        .text("Cancellation Rate");
    });
  </script>
</body>
</html>
